SELECT A.TREE_NODE_NUM, D.EMPLID, D.POSITION_NBR, D.NAME, D.JOBCODE, D.JOBCODE_DESCR, D.AC_BUSINESS_UNIT, D.AC_JDE_DESCR, D.REPORTS_TO, D.AC_SUPER_NAME, D.LOCATION, D.LOCATION_DESCR, E.COMPANY, E.GRADE, TO_CHAR(E.JOB_ENTRY_DT,'YYYY-MM-DD'), TO_CHAR(E.SERVICE_DT,'YYYY-MM-DD'), E.AC_EMAIL, E.UNION_CD, E.BARG_UNIT, F.STATE, I.MANAGER, G.AC_EXT_LVL01_NAME, G.AC_EXT_LVL02_NAME, G.AC_EXT_LVL03_NAME, G.AC_EXT_LVL04_NAME, G.AC_EXT_LVL05_NAME
  FROM PS_PSTREENODE_DW A, PS_AC_NSPOS_INC_VW D, PS_AC_POSN_SRCH D1, PS_AC_EMPLS_VW E, PS_EMPLMT_SRCH_QRY E1, PS_LOCATION_TBL F, PS_AC_REPTS_TO_LVL G, PS_WIN_EMPLOYMENT I
  WHERE ( D.POSITION_NBR = D1.POSITION_NBR
    AND D1.OPRCLASS = 'WIN_VW'
    AND E.EMPLID = E1.EMPLID
    AND E1.OPRID = 'E0182265'
    AND ( A.TREE_NODE_NUM >= (SELECT B.TREE_NODE_NUM
  FROM PS_PSTREENODE_DW B
  WHERE B.TREE_NODE = :1)
     AND A.TREE_NODE_NUM_END <= (SELECT C.TREE_NODE_NUM_END
  FROM PS_PSTREENODE_DW C
  WHERE C.TREE_NODE = :1)
     AND D.POSITION_NBR = A.TREE_NODE
     AND D.EMPLID = E.EMPLID
     AND D.POSITION_NBR = E.POSITION_NBR
     AND E.EMPLID = G.EMPLID
     AND E.POSITION_NBR = G.POSITION_NBR
     AND E.EMPLID = I.EMPLID
     AND F.LOCATION = D.LOCATION
     AND F.EFFDT =
        (SELECT MAX(F_ED.EFFDT) FROM PS_LOCATION_TBL F_ED
        WHERE F.SETID = F_ED.SETID
          AND F.LOCATION = F_ED.LOCATION
          AND F_ED.EFFDT <= SYSDATE) ))
