SELECT A.EMPLID, A.NAME, A.COMPANY, A.STATE, A.PAYGROUP, TO_CHAR(B.EARNS_BEGIN_DT,'YYYY-MM-DD'), TO_CHAR(B.EARNS_END_DT,'YYYY-MM-DD'), TO_CHAR(A.PAY_END_DT,'YYYY-MM-DD'), TO_CHAR(A.CHECK_DT,'YYYY-MM-DD'), B.ERNCD_REG_EARNS, B.COMPRATE_USED_REG, B.REG_EARN_HRS, B.REG_PAY, C.ERNCD, D.DESCR, C.COMPRATE_USED, C.OTH_HRS, C.OTH_EARNS, A.TOTAL_GROSS, A.TOTAL_DEDUCTIONS, A.TOTAL_TAXES, A.NET_PAY
  FROM (((PS_PAY_CHECK A LEFT OUTER JOIN  PS_PAY_EARNINGS B ON  A.COMPANY = B.COMPANY AND A.PAYGROUP = B.PAYGROUP AND A.PAY_END_DT = B.PAY_END_DT AND A.OFF_CYCLE = B.OFF_CYCLE AND A.PAGE_NUM = B.PAGE_NUM AND A.LINE_NUM = B.LINE_NUM AND A.SEPCHK = B.SEPCHK ) LEFT OUTER JOIN  PS_PAY_OTH_EARNS C ON  B.COMPANY = C.COMPANY AND B.PAYGROUP = C.PAYGROUP AND B.PAY_END_DT = C.PAY_END_DT AND B.OFF_CYCLE = C.OFF_CYCLE AND B.PAGE_NUM = C.PAGE_NUM AND B.LINE_NUM = C.LINE_NUM AND B.ADDL_NBR = C.ADDL_NBR ) LEFT OUTER JOIN  PS_EARNINGS_TBL D ON  C.ERNCD = D.ERNCD AND D.EFFDT =
        (SELECT MAX(D_ED.EFFDT) FROM PS_EARNINGS_TBL D_ED
        WHERE D.ERNCD = D_ED.ERNCD
          AND D_ED.EFFDT <= SYSDATE) )
  WHERE ( A.PAY_END_DT >= TO_DATE('2021-07-01','YYYY-MM-DD')
     AND A.EMPLID IN ('0174814'))
  ORDER BY 1, 8 DESC, 6 DESC, 7 DESC
