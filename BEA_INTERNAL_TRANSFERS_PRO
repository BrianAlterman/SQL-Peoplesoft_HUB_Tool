	
SELECT A.EMPLID, C.NAME, TO_CHAR(A.ACTION_DT,'YYYY-MM-DD'), TO_CHAR(A.EFFDT,'YYYY-MM-DD'), A.ACTION, A.ACTION_REASON, A.POSITION_NBR, TO_CHAR(A.POSITION_ENTRY_DT,'YYYY-MM-DD'), A.JOBCODE, D.DESCR, D.GRADE, A.AC_RANGEPEN, A.DEPTID, F.DESCR, TO_CHAR(A.JOB_ENTRY_DT,'YYYY-MM-DD'), A.REPORTS_TO, A.SUPERVISOR_ID, B.POSITION_NBR, B.JOBCODE, E.DESCR, E.GRADE, B.AC_RANGEPEN, B.DEPTID, G.DESCR, B.REPORTS_TO, B.SUPERVISOR_ID
  FROM PS_JOB A, PS_EMPLMT_SRCH_QRY A1, PS_JOB B, PS_EMPLMT_SRCH_QRY B1, PS_PERSONAL_DATA C, PS_PERALL_SEC_QRY C1, PS_JOBCODE_TBL D, PS_JOBCODE_TBL E, PS_DEPT_TBL F, PS_DEPT_TBL G
  WHERE ( A.EMPLID = A1.EMPLID
    AND A.EMPL_RCD = A1.EMPL_RCD
    AND A1.OPRID = 'E0182265'
    AND B.EMPLID = B1.EMPLID
    AND B.EMPL_RCD = B1.EMPL_RCD
    AND B1.OPRID = 'E0182265'
    AND C.EMPLID = C1.EMPLID
    AND C1.OPRID = 'E0182265'
    AND ( ( A.EFFDT BETWEEN TO_DATE('2023-01-01','YYYY-MM-DD') AND TO_DATE('2023-12-31','YYYY-MM-DD')
     AND A.PER_ORG = 'EMP'
     AND A.EMPL_STATUS IN ('A','L','P')
     AND A.ACTION IN ('PRO')
     AND A.EMPLID = B.EMPLID
     AND A.EMPL_RCD = B.EMPL_RCD
     AND B.EFFDT =
        (SELECT MAX(B_ED.EFFDT) FROM PS_JOB B_ED
        WHERE B.EMPLID = B_ED.EMPLID
          AND B.EMPL_RCD = B_ED.EMPL_RCD
          AND B_ED.EFFDT < A.EFFDT)
    AND B.EFFSEQ =
        (SELECT MAX(B_ES.EFFSEQ) FROM PS_JOB B_ES
        WHERE B.EMPLID = B_ES.EMPLID
          AND B.EMPL_RCD = B_ES.EMPL_RCD
          AND B.EFFDT = B_ES.EFFDT))
     AND A.EMPLID = C.EMPLID
     AND D.JOBCODE = A.JOBCODE
     AND D.EFFDT =
        (SELECT MAX(D_ED.EFFDT) FROM PS_JOBCODE_TBL D_ED
        WHERE D.SETID = D_ED.SETID
          AND D.JOBCODE = D_ED.JOBCODE
          AND D_ED.EFFDT <= SYSDATE)
     AND E.JOBCODE = B.JOBCODE
     AND E.EFFDT =
        (SELECT MAX(E_ED.EFFDT) FROM PS_JOBCODE_TBL E_ED
        WHERE E.SETID = E_ED.SETID
          AND E.JOBCODE = E_ED.JOBCODE
          AND E_ED.EFFDT <= SYSDATE)
     AND F.DEPTID = A.DEPTID
     AND F.EFFDT =
        (SELECT MAX(F_ED.EFFDT) FROM PS_DEPT_TBL F_ED
        WHERE F.SETID = F_ED.SETID
          AND F.DEPTID = F_ED.DEPTID
          AND F_ED.EFFDT <= SYSDATE)
     AND G.DEPTID = B.DEPTID
     AND G.EFFDT =
        (SELECT MAX(G_ED.EFFDT) FROM PS_DEPT_TBL G_ED
        WHERE G.SETID = G_ED.SETID
          AND G.DEPTID = G_ED.DEPTID
          AND G_ED.EFFDT <= SYSDATE) ))
