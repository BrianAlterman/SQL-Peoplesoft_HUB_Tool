SELECT DISTINCT D.POSITION_NBR, D.EMPLID, D.NAME, D.EMPL_STATUS, TO_CHAR(D.HIRE_DT,'YYYY-MM-DD'), TO_CHAR(D.REHIRE_DT,'YYYY-MM-DD'), TO_CHAR(D.SERVICE_DT,'YYYY-MM-DD'), D.AC_BUSINESS_UNIT, D.AC_JDE_DESCR, E.BARG_UNIT, D.LOCATION, H.ADDRESS1, H.CITY, H.STATE, H.POSTAL, D.JOBCODE, D.JOBCODE_DESCR, E.FLSA_STATUS, D.ANNUAL_RT, E.GRADE, E.SAL_ADMIN_PLAN, F.MIN_RT_ANNUAL, F.MID_RT_ANNUAL, F.MAX_RT_ANNUAL, G.AC_EXT_LVL01_NAME, G.AC_EXT_LVL02_NAME, G.AC_EXT_LVL03_NAME, G.AC_EXT_LVL04_NAME, G.AC_EXT_LVL05_NAME, G.AC_EXT_LVL06_NAME, G.AC_EXT_LVL07_NAME
  FROM PS_PSTREENODE_DW A, PS_AC_POSN_SBUD_VW D, PS_AC_POSN_SRCH D1, PS_POSITION_DATA E, PS_POSTN_SRCH_QRY E1, PS_SAL_GRADE_TBL F, PS_AC_REPTS_TO_LVL G, PS_LOCATION_TBL H
  WHERE ( D.POSITION_NBR = D1.POSITION_NBR
    AND D1.OPRCLASS = 'WIN_VW'
    AND E.POSITION_NBR = E1.POSITION_NBR
    AND E1.OPRID = 'E0182265'
    AND ( A.TREE_NODE_NUM >= (SELECT B.TREE_NODE_NUM
  FROM PS_PSTREENODE_DW B
  WHERE B.TREE_NODE = :1)
     AND A.TREE_NODE_NUM_END <= (SELECT C.TREE_NODE_NUM_END
  FROM PS_PSTREENODE_DW C
  WHERE C.TREE_NODE = :1)
     AND D.POSITION_NBR = A.TREE_NODE
     AND D.JOBCODE <> 'LC003'
     AND D.POSITION_NBR = E.POSITION_NBR
     AND E.EFFDT =
        (SELECT MAX(E_ED.EFFDT) FROM PS_POSITION_DATA E_ED
        WHERE E.POSITION_NBR = E_ED.POSITION_NBR
          AND E_ED.EFFDT <= SYSDATE)
     AND F.SAL_ADMIN_PLAN = E.SAL_ADMIN_PLAN
     AND F.GRADE = E.GRADE
     AND F.EFFDT =
        (SELECT MAX(F_ED.EFFDT) FROM PS_SAL_GRADE_TBL F_ED
        WHERE F.SETID = F_ED.SETID
          AND F.SAL_ADMIN_PLAN = F_ED.SAL_ADMIN_PLAN
          AND F.GRADE = F_ED.GRADE
          AND F_ED.EFFDT <= SYSDATE)
     AND D.POSITION_NBR = G.POSITION_NBR
     AND D.EMPLID = G.EMPLID
     AND H.LOCATION = D.LOCATION
     AND H.EFFDT =
        (SELECT MAX(H_ED.EFFDT) FROM PS_LOCATION_TBL H_ED
        WHERE H.SETID = H_ED.SETID
          AND H.LOCATION = H_ED.LOCATION
          AND H_ED.EFFDT <= SYSDATE) ))
