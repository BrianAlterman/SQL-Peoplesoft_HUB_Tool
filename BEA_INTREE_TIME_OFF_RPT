	
SELECT F.STATE, E.DEPTID, E.DEPTNAME, E.SUPERVISOR_ID, E.AC_SUPER_NAME, E.EMPLID, E.NAME, E.BARG_UNIT, TO_CHAR(G.DUR,'YYYY-MM-DD'), G.TRC, H.DESCR, SUM( G.TL_QUANTITY)
  FROM PS_PSTREENODE_DW A, PS_AC_NSPOS_INC_VW D, PS_AC_POSN_SRCH D1, PS_AC_EMPLSNS_VW E, PS_AC_EMPLMT_SRC E1, PS_LOCATION_TBL F, PS_TL_PAYABLE_TIME G, PS_TL_TRC_TBL H
  WHERE ( D.POSITION_NBR = D1.POSITION_NBR
    AND D1.OPRCLASS = 'WIN_VW'
    AND E.EMPLID = E1.EMPLID
    AND E.EMPL_RCD = E1.EMPL_RCD
    AND E1.OPRCLASS = 'WIN_VW'
    AND ( A.TREE_NODE_NUM >= (SELECT B.TREE_NODE_NUM
  FROM PS_PSTREENODE_DW B
  WHERE B.TREE_NODE = :1)
     AND A.TREE_NODE_NUM_END <= (SELECT C.TREE_NODE_NUM_END
  FROM PS_PSTREENODE_DW C
  WHERE C.TREE_NODE = :1)
     AND D.POSITION_NBR = A.TREE_NODE
     AND D.EMPLID = E.EMPLID
     AND E.PER_ORG = 'EMP'
     AND F.LOCATION = E.LOCATION
     AND F.EFFDT =
        (SELECT MAX(F_ED.EFFDT) FROM PS_LOCATION_TBL F_ED
        WHERE F.SETID = F_ED.SETID
          AND F.LOCATION = F_ED.LOCATION
          AND F_ED.EFFDT <= E.EFFDT)
     AND E.EMPLID = G.EMPLID
     AND E.EMPL_RCD = G.EMPL_RCD
     AND H.TRC = G.TRC
     AND H.EFFDT =
        (SELECT MAX(H_ED.EFFDT) FROM PS_TL_TRC_TBL H_ED
        WHERE H.TRC = H_ED.TRC
          AND H_ED.EFFDT <= SYSDATE)
     AND G.DUR BETWEEN TO_DATE(:2,'YYYY-MM-DD') AND TO_DATE(:3,'YYYY-MM-DD')
     AND G.TRC IN ('VA1','VAH','VAS','VBH','VBS','HOH','UDF') ))
  GROUP BY  F.STATE,  E.DEPTID,  E.DEPTNAME,  E.SUPERVISOR_ID,  E.AC_SUPER_NAME,  E.EMPLID,  E.NAME,  E.BARG_UNIT,  G.DUR,  G.TRC,  H.DESCR
  ORDER BY 1, 2, 5, 7, 9, 10
