SELECT A.EMPLID, A.NAME, A.COMPANY, A.STATE, B.ERNCD, C.DESCR, B.OTH_HRS, B.OTH_EARNS, TO_CHAR(D.EARNS_BEGIN_DT,'YYYY-MM-DD'), TO_CHAR(D.EARNS_END_DT,'YYYY-MM-DD'), TO_CHAR(A.PAY_END_DT,'YYYY-MM-DD'), TO_CHAR(A.CHECK_DT,'YYYY-MM-DD'), A.TOTAL_GROSS, A.TOTAL_TAXES, A.TOTAL_DEDUCTIONS, A.NET_PAY
  FROM PS_PAY_CHECK A, PS_PAY_OTH_EARNS B, PS_EARNINGS_TBL C, PS_PAY_EARNINGS D
  WHERE ( A.COMPANY = B.COMPANY
     AND A.PAYGROUP = B.PAYGROUP
     AND A.PAY_END_DT = B.PAY_END_DT
     AND A.OFF_CYCLE = B.OFF_CYCLE
     AND A.PAGE_NUM = B.PAGE_NUM
     AND A.LINE_NUM = B.LINE_NUM
     AND A.SEPCHK = B.SEPCHK
     AND A.PAY_END_DT = TO_DATE('2022-09-24','YYYY-MM-DD')
     AND A.EMPLID = '0186966'
     AND B.ERNCD = C.ERNCD
     AND C.EFFDT =
        (SELECT MAX(C_ED.EFFDT) FROM PS_EARNINGS_TBL C_ED
        WHERE C.ERNCD = C_ED.ERNCD)
     AND B.COMPANY = D.COMPANY
     AND B.PAYGROUP = D.PAYGROUP
     AND B.PAY_END_DT = D.PAY_END_DT
     AND B.OFF_CYCLE = D.OFF_CYCLE
     AND B.PAGE_NUM = D.PAGE_NUM
     AND B.LINE_NUM = D.LINE_NUM
     AND B.ADDL_NBR = D.ADDL_NBR)
  ORDER BY 12, 11
