SELECT DISTINCT A.TREE_NODE_NUM, A.TREE_NODE_NUM_END, D.POSITION_NBR, D.EMPLID, D.NAME, D.JOBCODE, D.JOBCODE_DESCR, D.LOCATION, D.LOCATION_DESCR, F.ADDRESS1, F.CITY, F.STATE, F.POSTAL, F.PHONE, D.EMPL_STATUS, TO_CHAR(D.HIRE_DT,'YYYY-MM-DD'), TO_CHAR(D.REHIRE_DT,'YYYY-MM-DD'), TO_CHAR(D.SERVICE_DT,'YYYY-MM-DD'), D.AC_BUSINESS_UNIT, D.AC_JDE_DESCR, D.DEPTID, D.DEPT_DESCR, D.REPORTS_TO, D.AC_SUPER_NAME, D.SUPERVISOR_ID, G.AC_EXT_LVL01_NAME, G.AC_EXT_LVL02_NAME, G.AC_EXT_LVL03_NAME, G.AC_EXT_LVL04_NAME, G.AC_EXT_LVL05_NAME, E.UNION_CD, I.DESCR, E.BARG_UNIT, H.DESCR, H.CONTRACT_NUM, H.AC_GOV_LOCAL
  FROM PS_PSTREENODE_DW A, PS_AC_NSPOS_INC_VW D, PS_LOCATION_TBL F, PS_AC_REPTS_TO_LVL G, (((PS_POSITION_DATA E INNER JOIN PS_POSTN_SRCH_QRY E1 ON (E.POSITION_NBR = E1.POSITION_NBR AND  E1.OPRID = 'E0182265' )) LEFT OUTER JOIN  PS_AC_BARG_UNIT H ON  H.BARG_UNIT = E.BARG_UNIT AND H.UNION_CD = E.UNION_CD AND H.EFFDT =
        (SELECT MAX(H_ED.EFFDT) FROM PS_AC_BARG_UNIT H_ED
        WHERE H.UNION_CD = H_ED.UNION_CD
          AND H.BARG_UNIT = H_ED.BARG_UNIT
          AND H_ED.EFFDT <= SYSDATE) ) LEFT OUTER JOIN  PS_UNION_TBL I ON  H.UNION_CD = I.UNION_CD AND H.BARG_UNIT = I.BARG_UNIT AND I.EFFDT =
        (SELECT MAX(I_ED.EFFDT) FROM PS_UNION_TBL I_ED
        WHERE I.UNION_CD = I_ED.UNION_CD
          AND I_ED.EFFDT <= SYSDATE) ), PS_AC_POSN_SRCH D1
  WHERE ( D.POSITION_NBR = D1.POSITION_NBR
    AND D1.OPRCLASS = 'WIN_VW'
    AND ( A.TREE_NODE_NUM >= (SELECT B.TREE_NODE_NUM
  FROM PS_PSTREENODE_DW B
  WHERE ( B.TREE_NODE = :1 ))
     AND A.TREE_NODE_NUM_END <= (SELECT C.TREE_NODE_NUM_END
  FROM PS_PSTREENODE_DW C
  WHERE ( C.TREE_NODE = :1 ))
     AND D.POSITION_NBR = A.TREE_NODE
     AND D.JOBCODE NOT LIKE 'LC%'
     AND D.LOCATION = F.LOCATION
     AND F.EFFDT =
        (SELECT MAX(F_ED.EFFDT) FROM PS_LOCATION_TBL F_ED
        WHERE F.SETID = F_ED.SETID
          AND F.LOCATION = F_ED.LOCATION
          AND F_ED.EFFDT <= SYSDATE)
     AND D.POSITION_NBR = G.POSITION_NBR
     AND D.POSITION_NBR = E.POSITION_NBR
     AND E.EFFDT =
        (SELECT MAX(E_ED.EFFDT) FROM PS_POSITION_DATA E_ED
        WHERE E.POSITION_NBR = E_ED.POSITION_NBR
          AND E_ED.EFFDT <= SYSDATE) ))
  ORDER BY 1, 23
