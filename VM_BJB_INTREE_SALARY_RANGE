SELECT A.TREE_NODE_NUM, D.EMPL_STATUS, D.EMPLID, D.NAME, D.POSITION_NBR, D.JOBCODE, D.JOBCODE_DESCR, F.LOCATION, F.LOCATION_NAME, D.REPORTS_TO, D.SUPERVISOR_ID, D.AC_SUPER_NAME, TO_CHAR(F.REVIEW_DT,'YYYY-MM-DD'), F.REVIEW_RATING, D.ANNUAL_RT, D.HOURLY_RT, F.AC_RANGEPEN, TO_CHAR(F.LAST_INCREASE_DT,'YYYY-MM-DD'), F.GRADE, F.SAL_ADMIN_PLAN, G.MIN_RT_ANNUAL, G.MID_RT_ANNUAL, G.MAX_RT_ANNUAL, F.LMRA_CD, F.BARG_UNIT, TO_CHAR(F.JOB_ENTRY_DT,'YYYY-MM-DD'), TO_CHAR(D.SERVICE_DT,'YYYY-MM-DD'), TO_CHAR(F.REHIRE_DT,'YYYY-MM-DD'), D.AC_BUSINESS_UNIT, D.AC_JDE_DESCR, H.AC_ACQUISITION_COD, I.AC_EXT_LVL01_NAME, I.AC_EXT_LVL02_NAME, I.AC_EXT_LVL03_NAME, I.AC_EXT_LVL04_NAME, I.AC_EXT_LVL05_NAME, I.AC_EXT_LVL06_NAME
  FROM PS_PSTREENODE_DW A, PS_AC_POSN_SBUD_VW D, PS_AC_POSN_SRCH D1, PS_JOBCODE_TBL E, PS_AC_EMPLS_VW F, PS_EMPLMT_SRCH_QRY F1, PS_SAL_GRADE_TBL G, PS_WIN_EMPLOYMENT H, PS_AC_REPTS_TO_LVL I
  WHERE ( D.POSITION_NBR = D1.POSITION_NBR
    AND D1.OPRCLASS = 'WIN_VW'
    AND F.EMPLID = F1.EMPLID
    AND F1.OPRID = 'E0182265'
    AND ( A.TREE_NODE_NUM >= (SELECT B.TREE_NODE_NUM
  FROM PS_PSTREENODE_DW B
  WHERE B.TREE_NODE = :1)
     AND A.TREE_NODE_NUM_END <= (SELECT C.TREE_NODE_NUM_END
  FROM PS_PSTREENODE_DW C
  WHERE C.TREE_NODE = :1)
     AND D.POSITION_NBR = A.TREE_NODE
     AND E.JOBCODE = D.JOBCODE
     AND E.EFFDT =
        (SELECT MAX(E_ED.EFFDT) FROM PS_JOBCODE_TBL E_ED
        WHERE E.SETID = E_ED.SETID
          AND E.JOBCODE = E_ED.JOBCODE
          AND E_ED.EFFDT <= SYSDATE)
     AND F.POSITION_NBR = D.POSITION_NBR
     AND F.EMPLID = D.EMPLID
     AND G.SAL_ADMIN_PLAN = F.SAL_ADMIN_PLAN
     AND G.GRADE = F.GRADE
     AND G.EFFDT =
        (SELECT MAX(G_ED.EFFDT) FROM PS_SAL_GRADE_TBL G_ED
        WHERE G.SETID = G_ED.SETID
          AND G.SAL_ADMIN_PLAN = G_ED.SAL_ADMIN_PLAN
          AND G.GRADE = G_ED.GRADE
          AND G_ED.EFFDT <= SYSDATE)
     AND H.EMPLID = D.EMPLID
     AND D.POSITION_NBR = I.POSITION_NBR
     AND D.EMPLID = I.EMPLID ))
