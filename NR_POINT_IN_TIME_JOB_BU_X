SELECT A.EMPLID, A.EMPL_STATUS, A.FULL_PART_TIME, A.STD_HOURS, A.SUPERVISOR_ID, A.REPORTS_TO, A.LOCATION, B.DESCR, B.CITY, B.STATE, A.COMPANY, A.POSITION_NBR, C.DESCR, A.JOBCODE, C.AC_BUSINESS_UNIT, D.DESCR, TO_CHAR(A.TERMINATION_DT,'YYYY-MM-DD'), A.ACTION, TO_CHAR(A.ACTION_DT,'YYYY-MM-DD'), A.ACTION_REASON
  FROM PS_JOB A, PS_EMPLMT_SRCH_QRY A1, PS_LOCATION_TBL B, PS_POSITION_DATA C, PS_POSTN_SRCH_QRY C1, PS_AC_JDE_CATCODE D
  WHERE ( A.EMPLID = A1.EMPLID
    AND A.EMPL_RCD = A1.EMPL_RCD
    AND A1.OPRID = 'E0182265'
    AND C.POSITION_NBR = C1.POSITION_NBR
    AND C1.OPRID = 'E0182265'
    AND ( A.EFFDT =
        (SELECT MAX(A_ED.EFFDT) FROM PS_JOB A_ED
        WHERE A.EMPLID = A_ED.EMPLID
          AND A.EMPL_RCD = A_ED.EMPL_RCD
          AND A_ED.EFFDT <= SYSDATE)
    AND A.EFFSEQ =
        (SELECT MAX(A_ES.EFFSEQ) FROM PS_JOB A_ES
        WHERE A.EMPLID = A_ES.EMPLID
          AND A.EMPL_RCD = A_ES.EMPL_RCD
          AND A.EFFDT = A_ES.EFFDT)
     AND A.EMPLID NOT LIKE 'V%'
     AND A.JOBCODE NOT LIKE 'LC%'
     AND A.EMPL_STATUS NOT IN ('A','L','P')
     AND B.LOCATION = A.LOCATION
     AND B.EFFDT =
        (SELECT MAX(B_ED.EFFDT) FROM PS_LOCATION_TBL B_ED
        WHERE B.SETID = B_ED.SETID
          AND B.LOCATION = B_ED.LOCATION
          AND B_ED.EFFDT <= A.EFFDT)
     AND C.POSITION_NBR = A.POSITION_NBR
     AND C.EFFDT =
        (SELECT MAX(C_ED.EFFDT) FROM PS_POSITION_DATA C_ED
        WHERE C.POSITION_NBR = C_ED.POSITION_NBR
          AND C_ED.EFFDT <= A.EFFDT)
     AND D.AC_BUSINESS_UNIT = C.AC_BUSINESS_UNIT
     AND D.EFFDT =
        (SELECT MAX(D_ED.EFFDT) FROM PS_AC_JDE_CATCODE D_ED
        WHERE D.AC_BUSINESS_UNIT = D_ED.AC_BUSINESS_UNIT
          AND D_ED.EFFDT <= A.EFFDT)
     AND A.TERMINATION_DT > TO_DATE('2016-12-31','YYYY-MM-DD') ))
